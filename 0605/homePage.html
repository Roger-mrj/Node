<style>
    html, body {
        height: 100%;
        margin: 0;
        padding: 0;
    }
    body {
        background-color: #FFF;
        overflow: hidden;
        font-family: "Trebuchet MS";
    }
    .info-box:hover .info-box-icon {
        font-size: 60px;
    }
    #waterMap{
        /*background-color: yellow;*/
        height: 100%;
        margin: 0;
        padding: 0;
    }
</style>

<div id="waterMap"></div>

<script>
    //加载一个动态地图图层
    var map;
    require(["dojo/dom",
        "dojo/on",
        "esri/map",
        "esri/layers/FeatureLayer",
        "esri/layers/ArcGISDynamicMapServiceLayer",
        "esri/layers/ArcGISTiledMapServiceLayer",
        "esri/toolbars/navigation",
        "esri/InfoTemplate",
        "dojo/domReady!"],function (
        dom, on, Map, FeatureLayer, ArcGISDynamicMapServiceLayer, Navigation, ArcGISTiledMapServiceLayer, InfoTemplate) {
        // map = new Map("watermap",{logo:false});
        var dynamicbaseMap = new ArcGISDynamicMapServiceLayer
        // ("http://202.111.178.10:36080/arcgis/rest/services/WaterSystemDisplayApplication/吉林省水系展示地图/MapServer",{"opacity":1});
        // ("http://202.111.178.10:36080/arcgis/rest/services/WaterSystemDisplayApplication/JL_features/MapServer",{"opacity":1});
        ("http://202.111.178.10:36080/arcgis/rest/services/WaterSystemDisplayApplication/JL_baseMap/MapServer",{"opacity":1});

        map = new Map("waterMap",{
            basemap: "osm", //显示的地图样式 此处为地图，basemap: "satellite", //实景图
            center:[126,44],
            zoom:7,
            slider: false,
            maxZoom: 18,//地图最大缩放级别
            minZoom: 1, //地图最小缩放级别
            logo: false,  //不显示Esri的logo
            // layers:[dynamicbaseMap]
        });

        map.addLayer(dynamicbaseMap);
    });
    function printFun() {
        require([
            "esri/config",
            "esri/dijit/Print",
            "esri/tasks/PrintTask",
            "esri/tasks/PrintTemplate",
            "esri/tasks/PrintParameters"
        ],function (esriConfig, Print, PrintTask, PrintTemplate,PrintParameters) {
            var url = 'http://202.111.178.10:36080/arcgis/rest/services/ExportWebMap/GPServer/ExportM';
            var printTask = newPrintTask(url);//实例一个PrintTask，参数为打印服务的地址
            var layouts = {
                name: "A4 Landscape",
                label: "Landscape (PDF)",
                format: "pdf",
                options: {
                    legendLayers: [],
                    scalebarUnit: "Miles",
                    titleText: "测试\n盛大打算"
                }
            };
            var template = newPrintTemplate();
            template.layoutOptions= layouts.options;
            template.layout = layouts.name;
            template.label = layouts.label;
            template.format = layouts.format;
            template.exportOptions = { dpi: 150 };
            var params = new PrintParameters();//打印参数
            params.map = map;//地图map
            params.template = template;
            printTask.execute(
                params,
                function (evt) {
                    window.open(evt.url, "_black");
                });
        });
    }
</script>
<script type="text/javascript">
    $(function () {
        $(".info-box").each(function (index, item) {
            $(item).hover(function () {
                //$(this).css({"background":"red"});
                var bg = $(this).find("span:eq(0)").attr("class").replace("info-box-icon", "").trim();
                if(bg) {
                    $(this).find("span:eq(0)").removeClass(bg);
                    $(this).addClass(bg);
                }else{
                    bg = $(this).attr("class").replace("info-box", "").trim();
                    $(this).find("span:eq(0)").addClass(bg);
                    $(this).removeClass(bg);
                }
            }, function () {
                var bg = $(this).attr("class").replace("info-box", "").trim();
                if(bg) {
                    $(this).find("span:eq(0)").addClass(bg);
                    $(this).removeClass(bg);
                }else {
                    bg = $(this).find("span:eq(0)").attr("class").replace("info-box-icon", "").trim();
                    $(this).find("span:eq(0)").removeClass(bg);
                    $(this).addClass(bg);
                }
            });
        });



        $(".info-box").each(function (index, item) {
            $(item).click(function () {
                if($(this).data("flag")){
                    return;
                }
                if ($(this).data("url")) {
                    location.hash = "#main";
                    loadPage(basePath + $(this).data("url"));
                }
                else
                    modals.info("该功能demo尚未完成，敬请期待！");
            })
        });

        $("#btn_msg").click(function(){
            modals.openWin({
                winId:"messageWin",
                title:'给【billJiang】留言',
                width:'750px',
                url:basePath+"/message/mail/edit"
            });
        })


    });
</script>